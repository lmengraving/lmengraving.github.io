---
const services = [
  {
    number: '01',
    title: '定制打标模具与工装',
    description: '设计耐用钢印与滚压模具，用于永久性零件标识与品牌应用。',
    capabilities: [
      { name: '旋转与滚压模具', detail: '精密雕刻滚轮，用于圆柱或平面表面的连续打标。' },
      { name: '冲击与压力钢印', detail: '重型钢印，用于金属冲压与压纹应用。' },
      { name: '烫金模具', detail: '导热黄铜与钢制模具，用于包装与装饰性品牌打标。' }
    ],
    icon: `<path d="M12 36L24 8L36 36" stroke="currentColor" stroke-width="2"/><path d="M16 28H32" stroke="currentColor" stroke-width="2"/><circle cx="24" cy="8" r="3" stroke="currentColor" stroke-width="2"/>`,
    images: [
      // 滚压模具优先，匹配"旋转与滚压模具"
      { src: '/EmbossingDieSet.jpeg', title: '大型压纹模具' },
      // 冲击钢印，匹配"冲击与压力钢印"
      { src: '/StampingDie.jpeg', title: '标志冲压模具' },
      { src: '/MarkingPunch.jpeg', title: '文字打标冲头' },
      // 烫金模具，匹配"烫金模具"
      { src: '/HotStampingDie.jpeg', title: '黄铜烫金模具套装' },
      { src: '/hardened-steel-marking-dies.jpeg', title: '热处理定制钢制打标模具' },
      { src: '/MarkingPunch2.jpeg', title: '品牌名称冲头' },
    ]
  },
  {
    number: '02',
    title: '工业激光打标与纹理加工',
    description: '非接触式永久性打标解决方案，用于品牌标识、功能性纹理与定制组件雕刻。',
    capabilities: [
      { name: '深度雕刻', detail: '高深度材料去除，用于模具型腔与 3D 纹理。' },
      { name: '激光退火', detail: '不锈钢与钛合金上的耐腐蚀黑色标记（医疗/航空航天应用）。' },
      { name: '条形码、二维码与 UID', detail: '精密打标序列号、条形码与二维码，实现产品全流程追溯。' }
    ],
    icon: `<path d="M24 4L44 24L24 44L4 24L24 4Z" stroke="currentColor" stroke-width="2"/><circle cx="24" cy="24" r="6" stroke="currentColor" stroke-width="2"/><path d="M24 10V18M24 30V38M10 24H18M30 24H38" stroke="currentColor" stroke-width="1.5"/>`,
    images: [
      // 深度/型腔优先，匹配"深度雕刻"
      { src: '/laser-engraved-mold-cavity.jpeg', title: '注塑模具精密激光纹理加工' },
      { src: '/high-precision-edm-electrode-text.jpeg', title: '塑胶模具精密激光纹理加工' },
      { src: '/InsertLogo.jpeg', title: '标志镶件雕刻' },
      // 滚轮/医疗，匹配"激光退火（医疗）"
      { src: '/Lasermarkingonroller.jpeg', title: '滚轮激光打标' },
      // 代码最后，匹配"条形码与 UID"
      { src: '/CavityID.jpeg', title: '型腔 ID 与标志' },
      { src: '/LaserPartCode.jpeg', title: '生产治具打标' },
      { src: '/rotary-laser-marking-anodized-aluminum.jpeg', title: '圆柱面旋转激光打标' },
      { src: '/laser-etched-graduations-stainless-steel.jpeg', title: '测量刻度精密激光蚀刻' },
    ]
  },
  {
    number: '03',
    title: '3D CNC 与激光雕刻',
    description: '结合 CNC 加工与激光技术的先进三维雕刻，适用于模具与产品。',
    capabilities: [
      { name: '多轴 CNC 加工', detail: '黄铜、紫铜、铝、不锈钢及淬硬钢的复杂 3D 几何形状与深腔雕刻。' },
      { name: '3D 激光雕刻', detail: '5轴激光技术，用于侧壁、轮廓及复杂模具表面几何形状。' },
      { name: '3D 图形与 Logo', detail: '在成型应用的轮廓表面上雕刻三维形状与 Logo。' }
    ],
    icon: `<path d="M24 4L42 14V34L24 44L6 34V14L24 4Z" stroke="currentColor" stroke-width="2"/><path d="M24 4V44M6 14L42 34M42 14L6 34" stroke="currentColor" stroke-width="1" opacity="0.5"/><circle cx="24" cy="24" r="4" fill="currentColor"/>`,
    images: [
      // 物理模具/型腔优先，匹配"CNC 加工"
      { src: '/Logo3DProfile.jpeg', title: '3D 轮廓与零件 ID' },
      // 组件/镶件打标
      { src: '/CavityInsert3DProfile.jpeg', title: '3D 轮廓型腔镶件' },
      { src: '/CavityInsert3D.jpeg', title: '3D 型腔镶件' },
      // 曲面激光，匹配"3D 激光雕刻"
      { src: '/Electrode3DProfileSymbol.jpeg', title: '3D 曲面雕刻' },
      { src: '/Engraving3DProfile.jpeg', title: '3D 轮廓芯针' },
      // 图形/点阵，匹配"3D 图形"
      { src: '/Electrode3DDot.jpeg', title: '3D 点阵图案电极' },
      { src: '/polished-mold-cores-consumer-goods.jpeg', title: '高抛光模具标志' },
    ]
  },
  {
    number: '04',
    title: '版本 ID 与 Logo 雕刻',
    description: '在模具组件与镶件上精密激光雕刻客户 Logo、ID、版本号及参考代码。',
    capabilities: [
      { name: 'Logo 雕刻', detail: '在模具型腔上雕刻定制品牌 Logo 与图形，用于永久性零件品牌标识。' },
      { name: '型腔编号', detail: '深度雕刻型腔编号与版本级别，以便清晰识别。' },
      { name: '组件打标', detail: '在镶件、滑块与斜顶上雕刻匹配 ID，辅助组装与维护。' }
    ],
    icon: `<rect x="8" y="8" width="32" height="32" stroke="currentColor" stroke-width="2"/><path d="M8 16H40M8 24H40M8 32H40" stroke="currentColor" stroke-width="1.5" opacity="0.5"/><rect x="12" y="12" width="8" height="8" fill="currentColor"/><rect x="28" y="12" width="8" height="8" fill="currentColor"/>`,
    images: [
      // Logo 优先
      { src: '/CavityInsert.jpeg', title: '零件 ID 雕刻' },
      { src: '/RevisionID&Logo.jpeg', title: '版本 ID 与品牌标志' },
      // 型腔/轮廓编号
      { src: '/cnc-engraved-regulatory-markings.jpeg', title: '法规合规标准 CNC 雕刻' },
      { src: '/Icon_Logo&PartCode.jpeg', title: '版本 ID 与品牌标志' },
      { src: '/LaserEngraving.jpeg', title: '激光雕刻零件标记' },
      { src: '/CNC.jpeg', title: 'CNC 标志雕刻' },
      { src: '/3dcnc.jpeg', title: '3D 模具型腔加工' },
    ]
  },
  {
    number: '05',
    title: 'EDM 电极雕刻',
    description: 'EDM 应用的电极激光雕刻。精密蚀刻石墨与铜电极。',
    capabilities: [
      { name: '石墨电极', detail: '用于 EDM 沉降加工的石墨电极精密激光蚀刻。' },
      { name: '铜电极', detail: '雕刻铜与铜浸渍电极，呈现复杂型腔的精细细节。' },
      { name: '火花位控制', detail: '可按指定的火花位 (Over-burn) 规格雕刻凸字或凹字。' }
    ],
    icon: `<circle cx="24" cy="24" r="16" stroke="currentColor" stroke-width="2"/><path d="M24 12V36" stroke="currentColor" stroke-width="2"/><path d="M16 20L24 12L32 20" stroke="currentColor" stroke-width="2"/><circle cx="24" cy="28" r="4" fill="currentColor"/>`,
    images: [
      // 通用品牌/石墨风格优先
      { src: '/ElectrodeLogo3D.jpeg', title: '3D 标志电极' },
      // 铜电极，匹配"铜电极"
      { src: '/ElectrodeEmbossingSymbol.jpeg', title: '3D 轮廓电极' },
      { src: '/ElectrodeLogoCopper.jpeg', title: '医疗器械电极' },
      // 复杂/火花位，匹配"火花位/细节"
      { src: '/ElectrodeLong.jpeg', title: '精密凸字标志' },
      { src: '/copper-edm-electrode-regulatory-symbols.jpeg', title: '图标定制铜 EDM 电极' },
      { src: '/copper-edm-electrode-branding.jpeg', title: '精密凸字标志' },
      { src: '/Electrode_Emboss_Year_Code.jpeg', title: '年份代码电极' },
      { src: '/ElectrodeLogo.jpeg', title: '图标电极雕刻' },
    ]
  }
];
---

<section id="services" class="py-16 md:py-24 lg:py-32 relative overflow-hidden bg-steel-900/30">
  <div class="absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-steel-700 to-transparent"></div>
  <div class="absolute top-1/3 left-0 w-1/3 h-80 bg-laser/5 blur-[120px] -translate-x-1/4"></div>
  <div class="absolute bottom-1/4 right-0 w-1/4 h-64 bg-precision-cyan/5 blur-[100px] translate-x-1/4"></div>

  <div class="max-w-7xl mx-auto px-6 lg:px-8 relative">
    <div class="text-center mb-10 md:mb-16 lg:mb-24">
      <div class="inline-flex items-center gap-3 mb-4 md:mb-6">
        <span class="w-8 h-[1px] bg-steel-600"></span>
        <span class="font-mono text-xs tracking-[0.3em] text-steel-400 uppercase">我们的业务</span>
        <span class="w-8 h-[1px] bg-steel-600"></span>
      </div>
      <h2 class="font-display text-3xl md:text-5xl lg:text-6xl font-bold tracking-tight text-white mb-4 md:mb-6">
        我们的 <span class="text-laser">服务</span>
      </h2>
      <p class="font-body text-base md:text-lg text-steel-400 max-w-3xl mx-auto hidden md:block">
        从精密模具组件到先进激光加工 —— 为高要求行业提供全面的制造解决方案。
      </p>
    </div>

    <!-- Mobile: Collapsible accordion -->
    <div class="md:hidden space-y-3">
      {services.map((service, index) => (
        <div class="service-accordion bg-steel-900/50 border border-steel-800" data-index={index}>
          <button
            class="service-toggle w-full flex items-center gap-4 p-4 text-left"
            aria-expanded="false"
          >
            <div class="w-10 h-10 flex items-center justify-center bg-laser/10 border border-laser/30 shrink-0">
              <svg viewBox="0 0 48 48" fill="none" class="w-5 h-5 text-laser" set:html={service.icon} />
            </div>
            <div class="flex-1 min-w-0">
              <h3 class="font-display text-base font-bold text-white truncate">{service.title}</h3>
            </div>
            <svg class="service-chevron w-5 h-5 text-steel-400 transition-transform duration-300 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="service-content hidden px-4 pb-4">
            <p class="font-body text-steel-400 text-sm mb-4">{service.description}</p>
            <div class="space-y-2 mb-4">
              {service.capabilities.map((cap) => (
                <div class="flex items-start gap-2 text-sm">
                  <span class="w-1.5 h-1.5 bg-laser rounded-full mt-1.5 shrink-0"></span>
                  <span class="text-steel-300">{cap.name}</span>
                </div>
              ))}
            </div>
            {service.images && service.images.length > 0 && (
              <div class="pt-4 border-t border-steel-800">
                <h4 class="font-mono text-[9px] tracking-widest text-steel-500 uppercase mb-3">案例展示</h4>
                <div class="grid grid-cols-2 gap-2">
                  {service.images.map((image: { src: string; title: string }) => (
                    <button
                      class="relative overflow-hidden bg-steel-950 border border-steel-700 lightbox-trigger text-left"
                      data-src={image.src}
                      data-title={image.title}
                      type="button"
                    >
                      <div class="aspect-[4/3]">
                        <img
                          src={image.src}
                          alt={image.title}
                          class="w-full h-full object-cover"
                          loading="lazy"
                        />
                      </div>
                      <div class="p-2 border-t border-steel-800">
                        <span class="font-body text-[10px] text-steel-400 line-clamp-1">{image.title}</span>
                      </div>
                    </button>
                  ))}
                </div>
              </div>
            )}
          </div>
        </div>
      ))}
    </div>

    <!-- Desktop: Full cards -->
    <div class="hidden md:block space-y-8">
      {services.map((service) => (
        <div class="bg-steel-900/30 border border-steel-800 hover:border-laser/30 transition-all duration-500 p-8 lg:p-10">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-1">
              <div class="flex items-center gap-4 mb-4">
                <div class="w-14 h-14 flex items-center justify-center bg-laser/10 border border-laser/30">
                  <svg viewBox="0 0 48 48" fill="none" class="w-8 h-8 text-laser" set:html={service.icon} />
                </div>
                <span class="font-mono text-[10px] tracking-widest text-laser uppercase">{service.number}</span>
              </div>
              <h3 class="font-display text-2xl font-bold text-white mb-3">{service.title}</h3>
              <p class="font-body text-steel-400 text-sm leading-relaxed">{service.description}</p>
            </div>

            <div class="lg:col-span-2">
              <h4 class="font-mono text-[10px] tracking-widest text-steel-500 uppercase mb-4">核心能力</h4>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {service.capabilities.map((cap) => (
                  <div class="bg-steel-950 border border-steel-800 p-5">
                    <div class="font-display text-lg font-semibold text-white mb-2">{cap.name}</div>
                    <p class="font-body text-steel-400 text-xs leading-relaxed">{cap.detail}</p>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Image showcase row - only for services with images */}
          {service.images && service.images.length > 0 && (
            <div class="mt-8 pt-8 border-t border-steel-800">
              <div class="flex items-center justify-between mb-5">
                <h4 class="font-mono text-[10px] tracking-widest text-steel-500 uppercase">案例展示</h4>
                {/* Carousel navigation - only show if more than 4 images */}
                {service.images.length > 4 && (
                  <div class="flex items-center gap-2">
                    <button
                      class="carousel-prev w-8 h-8 flex items-center justify-center border border-steel-700 hover:border-laser/50 hover:bg-steel-800 transition-all text-steel-400 hover:text-white"
                      type="button"
                      aria-label="上一页"
                    >
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                      </svg>
                    </button>
                    <span class="carousel-counter font-mono text-xs text-steel-500 min-w-[3rem] text-center">1 / 2</span>
                    <button
                      class="carousel-next w-8 h-8 flex items-center justify-center border border-steel-700 hover:border-laser/50 hover:bg-steel-800 transition-all text-steel-400 hover:text-white"
                      type="button"
                      aria-label="下一页"
                    >
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                      </svg>
                    </button>
                  </div>
                )}
              </div>
              <div class="image-carousel relative overflow-hidden" data-total={service.images.length}>
                <div class="carousel-track flex transition-transform duration-300 ease-out" style="gap: 1rem;">
                  {service.images.map((image: { src: string; title: string }) => (
                    <button
                      class="group/img relative overflow-hidden bg-steel-950 border border-steel-800 hover:border-laser/50 transition-all duration-300 cursor-pointer lightbox-trigger text-left flex-shrink-0"
                      style="width: calc(25% - 0.75rem);"
                      data-src={image.src}
                      data-title={image.title}
                      type="button"
                    >
                      <div class="aspect-[4/3] overflow-hidden">
                        <img
                          src={image.src}
                          alt={image.title}
                          class="w-full h-full object-cover transition-transform duration-500 group-hover/img:scale-105"
                          loading="lazy"
                        />
                      </div>
                      <div class="absolute inset-0 bg-gradient-to-t from-steel-950 via-steel-950/40 to-transparent opacity-0 group-hover/img:opacity-100 transition-opacity duration-300 pointer-events-none flex items-end justify-center pb-3">
                        <span class="text-white/90 text-xs font-mono tracking-wider flex items-center gap-2">
                          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7" />
                          </svg>
                          查看
                        </span>
                      </div>
                      <div class="p-3 border-t border-steel-800">
                        <span class="font-body text-xs text-steel-300 group-hover/img:text-white transition-colors">{image.title}</span>
                      </div>
                    </button>
                  ))}
                </div>
              </div>
            </div>
          )}
        </div>
      ))}
    </div>
  </div>
</section>

<!-- Lightbox Modal -->
<div id="lightbox" class="fixed inset-0 z-50 hidden items-center justify-center bg-steel-950/95 backdrop-blur-sm">
  <button id="lightbox-close" class="absolute top-6 right-6 text-white/70 hover:text-white transition-colors z-10" type="button">
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
    </svg>
  </button>
  <button id="lightbox-prev" class="absolute left-4 md:left-8 top-1/2 -translate-y-1/2 text-white/70 hover:text-white transition-colors p-2" type="button">
    <svg class="w-8 h-8 md:w-10 md:h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
    </svg>
  </button>
  <button id="lightbox-next" class="absolute right-4 md:right-8 top-1/2 -translate-y-1/2 text-white/70 hover:text-white transition-colors p-2" type="button">
    <svg class="w-8 h-8 md:w-10 md:h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
    </svg>
  </button>
  <div class="max-w-5xl max-h-[85vh] mx-4 md:mx-8 flex flex-col items-center">
    <img id="lightbox-img" src="" alt="Full size image" class="max-w-full max-h-[75vh] object-contain border border-steel-700 shadow-2xl" />
    <div id="lightbox-title" class="mt-4 font-display text-lg text-white text-center"></div>
  </div>
  <div id="lightbox-counter" class="absolute bottom-6 left-1/2 -translate-x-1/2 font-mono text-xs text-steel-400"></div>
</div>

<script>
  // Accordion functionality
  const accordions = document.querySelectorAll('.service-accordion');

  accordions.forEach(accordion => {
    const toggle = accordion.querySelector('.service-toggle');
    const content = accordion.querySelector('.service-content');
    const chevron = accordion.querySelector('.service-chevron');

    toggle?.addEventListener('click', () => {
      const isExpanded = toggle.getAttribute('aria-expanded') === 'true';

      // Close all other accordions
      accordions.forEach(other => {
        if (other !== accordion) {
          other.querySelector('.service-toggle')?.setAttribute('aria-expanded', 'false');
          other.querySelector('.service-content')?.classList.add('hidden');
          other.querySelector('.service-chevron')?.classList.remove('rotate-180');
        }
      });

      // Toggle current accordion
      toggle.setAttribute('aria-expanded', (!isExpanded).toString());
      content?.classList.toggle('hidden');
      chevron?.classList.toggle('rotate-180');
    });
  });

  // Lightbox functionality
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightbox-img') as HTMLImageElement;
  const lightboxTitle = document.getElementById('lightbox-title');
  const lightboxClose = document.getElementById('lightbox-close');
  const lightboxPrev = document.getElementById('lightbox-prev');
  const lightboxNext = document.getElementById('lightbox-next');
  const lightboxCounter = document.getElementById('lightbox-counter');
  const triggers = document.querySelectorAll('.lightbox-trigger');

  interface ImageData {
    src: string;
    title: string;
  }

  let currentImages: ImageData[] = [];
  let currentIndex = 0;

  function openLightbox(src: string, images: ImageData[]) {
    currentImages = images;
    currentIndex = images.findIndex(img => img.src === src);
    if (currentIndex === -1) currentIndex = 0;
    updateLightboxImage();
    lightbox?.classList.remove('hidden');
    lightbox?.classList.add('flex');
    document.body.style.overflow = 'hidden';
  }

  function closeLightbox() {
    lightbox?.classList.add('hidden');
    lightbox?.classList.remove('flex');
    document.body.style.overflow = '';
  }

  function updateLightboxImage() {
    const current = currentImages[currentIndex];
    if (lightboxImg && current) {
      lightboxImg.src = current.src;
      lightboxImg.alt = current.title;
    }
    if (lightboxTitle && current) {
      lightboxTitle.textContent = current.title;
    }
    if (lightboxCounter) {
      lightboxCounter.textContent = `${currentIndex + 1} / ${currentImages.length}`;
    }
    // Hide nav buttons if only one image
    if (currentImages.length <= 1) {
      lightboxPrev?.classList.add('hidden');
      lightboxNext?.classList.add('hidden');
      lightboxCounter?.classList.add('hidden');
    } else {
      lightboxPrev?.classList.remove('hidden');
      lightboxNext?.classList.remove('hidden');
      lightboxCounter?.classList.remove('hidden');
    }
  }

  function nextImage() {
    currentIndex = (currentIndex + 1) % currentImages.length;
    updateLightboxImage();
  }

  function prevImage() {
    currentIndex = (currentIndex - 1 + currentImages.length) % currentImages.length;
    updateLightboxImage();
  }

  triggers.forEach(trigger => {
    trigger.addEventListener('click', () => {
      const src = trigger.getAttribute('data-src');
      const title = trigger.getAttribute('data-title') || '';
      // Find sibling images in the same container (carousel-track or grid)
      const container = trigger.closest('.carousel-track') || trigger.closest('.grid');
      const siblingTriggers = container?.querySelectorAll('.lightbox-trigger');
      const images: ImageData[] = [];
      siblingTriggers?.forEach(t => {
        const imgSrc = t.getAttribute('data-src');
        const imgTitle = t.getAttribute('data-title') || '';
        if (imgSrc) images.push({ src: imgSrc, title: imgTitle });
      });
      if (src) openLightbox(src, images);
    });
  });

  lightboxClose?.addEventListener('click', closeLightbox);
  lightboxPrev?.addEventListener('click', prevImage);
  lightboxNext?.addEventListener('click', nextImage);

  // Close on background click
  lightbox?.addEventListener('click', (e) => {
    if (e.target === lightbox) closeLightbox();
  });

  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (lightbox?.classList.contains('hidden')) return;
    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowRight') nextImage();
    if (e.key === 'ArrowLeft') prevImage();
  });

  // Image carousel functionality
  const carousels = document.querySelectorAll('.image-carousel');

  carousels.forEach(carousel => {
    const track = carousel.querySelector('.carousel-track') as HTMLElement;
    const container = carousel.closest('.border-t');
    const prevBtn = container?.querySelector('.carousel-prev');
    const nextBtn = container?.querySelector('.carousel-next');
    const counter = container?.querySelector('.carousel-counter');
    const totalImages = parseInt(carousel.getAttribute('data-total') || '0');

    if (totalImages <= 4) return; // No carousel needed

    let currentPage = 0;
    const imagesPerPage = 4;
    const totalPages = Math.ceil(totalImages / imagesPerPage);

    function updateCarousel() {
      if (!track) return;
      // Calculate offset: each image is 25% width with gap
      const slideWidth = track.scrollWidth / totalImages;
      const offset = currentPage * imagesPerPage * slideWidth;
      track.style.transform = `translateX(-${offset}px)`;

      // Update counter
      if (counter) {
        counter.textContent = `${currentPage + 1} / ${totalPages}`;
      }

      // Update button states
      prevBtn?.classList.toggle('opacity-30', currentPage === 0);
      prevBtn?.classList.toggle('pointer-events-none', currentPage === 0);
      nextBtn?.classList.toggle('opacity-30', currentPage === totalPages - 1);
      nextBtn?.classList.toggle('pointer-events-none', currentPage === totalPages - 1);
    }

    prevBtn?.addEventListener('click', () => {
      if (currentPage > 0) {
        currentPage--;
        updateCarousel();
      }
    });

    nextBtn?.addEventListener('click', () => {
      if (currentPage < totalPages - 1) {
        currentPage++;
        updateCarousel();
      }
    });

    // Initialize
    updateCarousel();
  });
</script>